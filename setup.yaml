---
- hosts: all
  vars:
    conda_user_group: hackathon
    path_extra_conda: /opt/extra_conda_pkgs
    miniconda_prefix: /opt/miniconda3
    miniconda_python_version: 38
    miniconda_version: "4.10.3"
    miniconda_installer: Miniconda3-py{{ miniconda_python_version }}_{{ miniconda_version }}-Linux-x86_64.sh
    miniconda_installer_checksum: ""
    miniconda_update_conda: False
    miniconda_env: ""
    miniconda_manage_dependencies: True
    miniconda_env_create_opts: '-q'
    miniconda_env_update_opts: ''
  tasks:
    - name: Enable EPEL Repository
      yum:
        name: epel-release
        state: latest
      become: true
    
    - name: Create usergroup hackathon
      ansible.builtin.group:
        name: "{{ conda_user_group }}"
        state: present
      become: true
    
    - name: Add centos into hackathon
      ansible.builtin.user:
        name: centos
        group: "{{ conda_user_group }}"
      become: true
    
    - name: Install conda
      include: 'install-multiple-user-conda.yaml'
    
    - name: Add users
      include: 'create-users.yaml'